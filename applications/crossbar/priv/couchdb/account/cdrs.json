{
    "_id": "_design/cdrs",
    "language": "javascript",
    "views": {
        "crossbar_listing": {
            "map": "function(doc) {if (doc.pvt_deleted || doc.pvt_type != 'cdr') return; emit(doc.pvt_created, null);}"
        },
        "listing_by_owner" : {
            "map": "function(doc) {if (doc.pvt_type != 'cdr' || doc.pvt_deleted || !doc.custom_channel_vars || !doc.custom_channel_vars.owner_id) return;emit([doc.custom_channel_vars.owner_id, doc.pvt_created], {'owner_id': doc.custom_channel_vars.owner_id,'id': doc._id})}"
        },
       "offnet-calls": {
           "map": "function(doc) { if(doc.pvt_type != 'cdr' || !doc.custom_channel_vars.global_resource || doc.custom_channel_vars.channel_authorized != 'true' || doc.pvt_deleted || !doc.custom_channel_vars) return; emit([doc.call_id, doc.pvt_created], {'id':doc._id, 'call_id': doc.call_id, 'caller_id_name': doc.caller_id_name, 'caller_id_number': doc.caller_id_number, 'callee_id_name': doc.callee_id_name, 'callee_id_number': doc.callee_id_number, 'duration_seconds': doc.duration_seconds, 'timestamp': doc.timestamp, 'hangup_cause':doc.hangup_cause, 'other_leg_call_id':doc.other_leg_call_id, 'call_direction':doc.call_direction, 'to': doc.to_uri, 'from': doc.from_uri, 'inception':doc.custom_channel_vars.inception})}"
       }
   }
}
